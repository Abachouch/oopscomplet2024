'use client';
import { useEffect, useState } from "react";
import  moment from 'moment';


export default function FeedItem({name , age , location , time , avatar , website , bustedBy} : { website :string , bustedBy:string , name : string , age : string , location : string , time : number , avatar : string}) {
    function convertMinutesToHours(minutes: number) {
   
    if(minutes < 60) {
        return `${minutes} mins`;
    }

    const duration = moment.duration(minutes, 'minutes');
    const hours = Math.floor(duration.asHours());
    const mins = Math.floor(duration.minutes());

    if(mins === 0) {
        return `${hours} hours`;
    }

    return `${hours} hours ${mins} mins`;
}


    function getFirstName(fullName: string) {
        const nameParts = fullName.split(' ');
        const firstName = nameParts[0];
        return firstName;
    }

    const  [currentTime , setCurrentTime] = useState(time);

    useEffect(() => {
        const timer = setInterval(() => {
            setCurrentTime(prevTime => prevTime + 1);
        }, 60000);
        return () => clearInterval(timer);
    }, []);

    return (
        <li className="recent">
            <div className="relative recent-avatar "  >
                <img src={avatar} alt={'avatar of '+getFirstName(name)} title="avatar photo" width={100} height={100} />
                {
                    (website == 'tinder' ) && 
                    <svg className="absolute right-0 -bottom-0" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="12" fill="#F71C06"/>
                        <path fillRule="evenodd" clipRule="evenodd" d="M9.06058 10.5495C11.9242 9.56244 12.4116 6.99128 12.046 4.62727C12.046 4.54197 12.1192 4.48104 12.1923 4.50542C14.934 5.84583 18.017 8.77038 18.017 13.1572C18.017 16.5204 15.4093 19.4937 11.6195 19.4937C10.2673 19.5552 8.93302 19.1646 7.82739 18.3836C6.72176 17.6025 5.90772 16.4755 5.51375 15.1804C5.11978 13.8854 5.16831 12.4959 5.6517 11.2315C6.13508 9.96709 7.02578 8.89964 8.18322 8.19765C8.25633 8.14891 8.35382 8.19765 8.35382 8.28295C8.39037 8.73382 8.51223 9.86708 9.01184 10.5495H9.06058Z" fill="white"/>
                    </svg>

                }
                {   
                    (website == 'hinge' ) && 
                    <svg  className="absolute right-0 -bottom-0"  width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="12" fill="#F71C06"/>
                        <path fillRule="evenodd" clipRule="evenodd" d="M16.7398 6.50001C16.1411 6.49738 15.6643 6.96789 15.6624 7.5627V7.56204C15.6605 7.84493 15.7711 8.11699 15.9699 8.31836C16.1686 8.51974 16.4392 8.63393 16.7221 8.63584C17.0051 8.63773 17.2773 8.52718 17.4786 8.32849C17.68 8.1298 17.7942 7.85925 17.7962 7.57636C17.7985 6.98369 17.3269 6.50248 16.7398 6.50001ZM15.155 12.2904C15.3596 12.2143 15.5586 12.1239 15.7505 12.0198C15.7682 12.0547 15.7668 12.0844 15.7655 12.1119C15.7651 12.1193 15.7648 12.1266 15.7648 12.1337V17.0021C15.7648 17.1174 15.7651 17.1174 15.8756 17.1174C16.0165 17.1174 16.1574 17.1173 16.2983 17.1172C16.6758 17.1169 17.0535 17.1167 17.431 17.1192C17.5124 17.1197 17.5379 17.0992 17.5379 17.0143C17.5357 14.7583 17.5357 12.5023 17.5379 10.2462C17.5381 10.1716 17.5101 10.142 17.445 10.1176C17.0217 9.95876 16.5988 9.79841 16.1781 9.63296C16.0982 9.60151 16.0628 9.60826 16.0228 9.69058C15.7195 10.3129 15.2202 10.655 14.5308 10.7302C14.2652 10.7593 13.9996 10.76 13.7337 10.7608C13.6681 10.761 13.6024 10.7612 13.5367 10.7618C13.4205 10.7636 13.4205 10.7626 13.4205 10.6466V6.76494C13.4205 6.6553 13.4201 6.6553 13.3114 6.6553H11.7725C11.6491 6.6553 11.6491 6.65563 11.6491 6.78289V10.6474C11.6491 10.7626 11.649 10.7626 11.5316 10.7626C11.0296 10.7634 10.5275 10.7634 10.0254 10.7626C9.70988 10.7623 9.39604 10.7771 9.08317 10.8252C8.52496 10.9113 8.00576 11.096 7.54256 11.4253C7.5393 11.4276 7.53614 11.4304 7.53292 11.4333C7.52021 11.4448 7.50649 11.4571 7.48114 11.4429V11.3474V6.76675C7.48114 6.65645 7.48097 6.65546 7.37377 6.65546H5.81835C5.70884 6.65546 5.70884 6.65678 5.70884 6.76576C5.70961 10.1814 5.70901 13.597 5.70703 17.0127C5.70703 17.095 5.7291 17.12 5.81324 17.12C6.20778 17.1172 6.60279 17.1175 6.99777 17.1178C7.12141 17.1179 7.24505 17.118 7.36868 17.118C7.48114 17.118 7.48114 17.1177 7.48114 17.0054C7.48119 16.7647 7.48103 16.5241 7.48088 16.2834C7.48051 15.7154 7.48014 15.1474 7.48245 14.5794C7.48361 14.3137 7.49942 14.0485 7.56051 13.7879C7.67676 13.2942 7.94155 12.9267 8.42961 12.7435C8.67698 12.6522 8.93778 12.6025 9.20139 12.5965C9.70743 12.5826 10.2136 12.5845 10.7198 12.5864C10.99 12.5874 11.2601 12.5885 11.5303 12.5871C11.648 12.5866 11.648 12.5874 11.648 12.7041C11.6492 14.1406 11.6487 15.577 11.6463 17.0133C11.6462 17.0956 11.6673 17.12 11.7514 17.12C12.1415 17.1171 12.5313 17.1175 12.9209 17.1178C13.047 17.1179 13.1731 17.118 13.2993 17.118C13.42 17.118 13.42 17.1179 13.42 16.9967V12.7203C13.42 12.7121 13.4202 12.7039 13.4204 12.6957C13.4209 12.6792 13.4214 12.6627 13.42 12.6463C13.4162 12.5976 13.4351 12.5775 13.4858 12.5775C13.5783 12.5759 13.6706 12.57 13.7629 12.5641C13.7718 12.5635 13.7807 12.563 13.7896 12.5624C14.2568 12.5316 14.7134 12.4493 15.155 12.2904Z" fill="white"/>
                    </svg>

                    }
                { 
                    (website == 'bumble' ) && 
                    <svg  className="absolute right-0 -bottom-0"  width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="12" fill="#F71C06"/>
                        <path d="M19.7288 11.4894C19.9098 11.805 19.9098 12.195 19.7288 12.5106L16.2706 18.4894C16.1812 18.6443 16.0527 18.773 15.8979 18.8626C15.7431 18.9522 15.5675 18.9996 15.3887 19H8.4723C8.29346 18.9996 8.11786 18.9522 7.96308 18.8626C7.80831 18.773 7.67977 18.6443 7.59035 18.4894L4.13682 12.5106C4.04719 12.3554 4 12.1793 4 12C4 11.8207 4.04719 11.6446 4.13682 11.4894L7.59035 5.51061C7.67977 5.35572 7.80831 5.22704 7.96308 5.13743C8.11786 5.04782 8.29346 5.00043 8.4723 5H15.3887C15.7507 5 16.0849 5.19496 16.2706 5.51061L19.7288 11.4894ZM15.4212 12.8773C15.8993 12.8773 16.2892 12.4828 16.2892 12C16.2892 11.5172 15.8993 11.1273 15.4212 11.1273H8.44445C8.21239 11.1273 7.98983 11.2195 7.82574 11.3836C7.66165 11.5477 7.56946 11.7703 7.56946 12.0023C7.56946 12.2344 7.66165 12.4569 7.82574 12.621C7.98983 12.7851 8.21239 12.8773 8.44445 12.8773H15.4165H15.4212ZM12.9888 15.8481C13.4623 15.8481 13.8476 15.4582 13.8476 14.9755C13.8476 14.4927 13.4623 14.0981 12.9888 14.0981H10.8675C10.394 14.0981 10.0088 14.4927 10.0088 14.9755C10.0088 15.4582 10.394 15.8481 10.8675 15.8481H12.9842H12.9888ZM10.0088 8.1565C9.53064 8.1565 9.14073 8.54642 9.14073 9.02918C9.14073 9.51194 9.53064 9.9065 10.0088 9.9065H13.8522C14.3303 9.9065 14.7202 9.51194 14.7202 9.02918C14.7202 8.54642 14.3303 8.1565 13.8522 8.1565H10.0088Z" fill="white"/>
                    </svg>

                }
            </div>
            <span className="recent-name">{getFirstName(name)}, {age} <span className="text-[#6F6F6F] font-medium">busted by {bustedBy} on </span>{website}</span>
            <span className="recent-address">{location}</span>
            <span className="recent-time">Busted {convertMinutesToHours(currentTime)} ago</span>
        </li>
    );
}